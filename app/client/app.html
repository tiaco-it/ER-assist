<!-- Basic screen setup -->

<head>
  <title>Offline App</title>
  <meta add="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
</head>
<body></body>

<!-- Standard markup for the general layout of the pages in our app is below -->
<!-- You have a top bar and a view with content -->
<!-- Standard setup is that ionBody contains ionView which contains ionContent -->

<!-- The layout template is the general layout of the app, router puts it inside "body" for any page  -->

<template name="defaultLayout">
  {{#ionBody}}
    {{> ionNavBar class="bar-positive"}}

<!-- Yield is used to get NavView content from the template (other than main layout template) that is active. The active template is the one chosen by the route -->  

    {{#ionNavView}}
      {{> yield}}
    {{/ionNavView}}
  {{/ionBody}}
</template>

<!-- Path is the router version of links. The router creates a link based on the route the path keyword refers to  -->

<template name="new">
  <div class="bar bar-header bar-positive">
    {{>ionNavBackButton path="home" text="Back"}}
    <div class="title">Edit Element</div>
  </div>

<!-- quickForm is a quick use of AutoForm which supplies basic, simple forms for filling out a specific schema (that we specify with SimpleSchema) -->

  {{#ionView}}
    {{#ionContent class="padding"}}
      {{> quickForm schema="ElementsSchema" collection="Elements" id="insertElementForm" type="normal" omitFields="createdAt, lastUpdated"}}
    {{/ionContent}}
  {{/ionView}}
</template>

<!-- The BackButton is connected to the main view through the path  -->

<template name="edit">
  <div class="bar bar-header bar-positive">
    {{>ionNavBackButton path="home" text="Back"}}
    <div class="title">Edit Element</div>
  </div>

<!-- Subscriptions connect the page to collections, can only submit data to collection if subscribed to it -->

  {{#ionView}}
    {{#ionContent class="padding"}}
      {{#if Template.subscriptionsReady}}
        {{> quickForm schema="ElementsSchema" collection="Elements" id="editElementForm" type="normal" doc=selectedDoc omitFields="createdAt, lastUpdated"}}
      {{else}}
        {{> spinner}}
      {{/if}}
    {{/ionContent}}
  {{/ionView}}
</template>

<!-- contentFor means content for the element, in this case "headerTitle" which is one of 3 regions supplied by the IonNavBar. In general ion elements can supply regions where content is displayed if put inside contentFor "regionName" -->

<template name="home">
  {{#contentFor "headerTitle"}}
    <h1 class="title">Offline application</h1>
  {{/contentFor}}

<!-- pathFor creates a link dynamically based on info from the route.  -->
<!-- In this case, base version, it refers to the simple route 'new' -->

<!-- {{#each}} iterates over over elements in the named object. {{ (attribute) }} can then be used to get attributes from each element. HTML and ion elements are then used to format and enclose the output content -->

  {{#ionView}}
    {{#ionContent}}
      {{#if Template.subscriptionsReady}}
        {{#ionList}}
<!-- startcases here refers to a helper method in app.js which returns an array of objects -->
          {{#each scase in startcases}}
            {{#if oneEither scase}}
              {{#ionItem}}
                <p>One outcome</p>
                {{#with to scase}}
                  <a href="{{pathFor 'law'}}" level="start" class="button">
                    <p>{{scase.text}}</p>
                  </a>
                {{/with}}
              {{/ionItem}}
            {{else}}
              {{#if twoEither scase}}
                {{#if notClicked scase.text}}
                  {{#ionItem}}
                    {{#with to scase}}
                      <p>Two outcomes</p>
                      <button class="button" level="start" id="{{ scase.text }}">
                        <p>{{scase.text}}</p>
                      </button>
                    {{/with}}
                  {{/ionItem}}
                {{else}}
                  {{#ionItem}}
                    <p>{{currentFrom.text}}</p>
                    {{#with yesLink currentFrom}}
                      {{#if oneYes currentFrom}}
                        <a href="{{pathFor 'law'}}" class="button" level="end">
                          <p>Ja</p>
                        </a>
                      {{else}}
                        {{#if twoYes currentFrom}}
                          <button class="button" level="inter" id = "{{ noLink.text }}">
                            <p>Ja</p>
                          </button>
                        {{else}}
                          <a href = "{{pathFor 'step'}}" class="button" level="end">
                            <p>Ja</p>
                          </a>
                        {{/if}}
                      {{/if}}
                    {{/with}}
                    {{#with noLink currentFrom}}
                      {{#if oneNo currentFrom}}
                        <a href="{{pathFor 'law'}}" class="button" level="end">
                          <p>Nei</p>
                        </a>
                      {{else}}
                        {{#if twoNo currentFrom}}
                          <button class="button" level="inter" id = "{{ noLink.text }}">
                            <p>Nei</p>
                          </button>
                        {{else}}
                          <a href = "{{pathFor 'step'}}" class="button" level="end">
                            <p>Nei</p>
                          </a>
                        {{/if}}
                      {{/if}}
                    {{/with}}
                  {{/ionItem}}
                {{/if}}
              {{else}}
                {{#with to scase}}
                  {{#ionItem}}
                    <a href="{{pathFor 'step'}}" level="start" class="button">
                      <p>n > 2 outcomes</p>
                      <p>{{scase.text}}</p>
                    </a>
                  {{/ionItem}}
                {{/with}}
              {{/if}}
            {{/if}}
          {{/each}}
        {{/ionList}}
      {{else}}
        {{> spinner}}
      {{/if}}
    {{/ionContent}}
    {{> tabs}}
  {{/ionView}}
</template>

<!-- Tentative template for displaying all laws (For shortcut directly to law) -->

<template name="laws">
  {{#contentFor "headerTitle"}}
    <h1 class="title">Laws</h1>
  {{/contentFor}}

  {{#contentFor "headerButtonRight"}}
    <!-- This button is a placeholder -->
    <a href="{{pathFor 'new'}}" class="button button-clear">{{> ionIcon icon="ios-plus-empty"}}</a>
  {{/contentFor}}


  {{#contentFor "headerButtonLeft"}}
  <!-- This button is a placeholder -->
    {{>ionNavBackButton text="Back"}}
  {{/contentFor}}

  {{#ionView}}
    {{#ionContent}}
      {{#ionList}}
        <!-- For each item in laws (from the helper, check js file) -->
        {{#each laws}}
          {{#ionItem path="law" buttonRight=true}}
            <!-- Paragraph from laws collection -->
              <h2>{{law}}</h2>
              <p>{{paragraph}}</p>
          {{/ionItem}}
        {{/each}}
      {{/ionList}}
    {{/ionContent}}
    {{> tabs}}
  {{/ionView}}
</template>


<!-- Tentative template for displaying one law -->
<template name='law'>
  <div class="bar bar-header bar-positive">
    {{>ionNavBackButton text="Back"}}
    <div class="title">Single Law</div>
  </div>

  {{#ionView}}
    {{#ionContent}}
      {{#with thisLaw}}
        <h1>{{Law}}</h1>
        <h2>{{paragraph}}</h2>
        <p>{{text}}</p>
      {{/with}}
    {{/ionContent}}
  {{/ionView}}
</template>

<template name="tabs">
  {{#if isAndroid}}
    {{#ionTabs style="android" class="tabs-background-positive tabs-color-light"}}
      {{> ionTab title="Hjem" path="home" icon="android-home"}}
      {{> ionTab title="Lover" path="laws" icon="android-star"}}
      {{> ionTab title="Lenker" path="tabs.three" icon="android-globe"}}
      {{> ionTab title="Info" path="tabs.four" icon="gear-b"}}
    {{/ionTabs}}
  {{else}}
    {{#ionTabs style="ios"}}
      {{> ionTab title="Hjem" path="home" iconOff="ios-home-outline" iconOn="ios-home"}}
      {{> ionTab title="Lover" path="laws" iconOff="ios-book-outline" iconOn="ios-book"}}
      {{> ionTab title="Lenker" path="tabs.three" iconOff="ios-world-outline" iconOn="ios-world"}}
      {{> ionTab title="Info" path="tabs.four" iconOff="ios-information-outline" iconOn="ios-information"}}
    {{/ionTabs}}
  {{/if}}
</template>
